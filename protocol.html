<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>Distributed Array Protocol v1.0.0</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="distributed-array-protocol-v1-0-0">
<h1 class="title">Distributed Array Protocol v1.0.0</h1>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id19">Overview</a></li>
<li><a class="reference internal" href="#usecases" id="id20">Usecases</a></li>
<li><a class="reference internal" href="#sources" id="id21">Sources</a></li>
<li><a class="reference internal" href="#definitions" id="id22">Definitions</a></li>
<li><a class="reference internal" href="#exporting-a-distributed-array" id="id23">Exporting a Distributed Array</a></li>
<li><a class="reference internal" href="#dimension-dictionaries" id="id24">Dimension Dictionaries</a><ul>
<li><a class="reference internal" href="#required-key-value-pairs" id="id25">Required key-value pairs</a></li>
<li><a class="reference internal" href="#optional-key-value-pairs" id="id26">Optional key-value pairs</a></li>
<li><a class="reference internal" href="#distribution-type-specific-key-value-pairs" id="id27">Distribution-type specific key-value pairs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id28">Examples</a><ul>
<li><a class="reference internal" href="#block-undistributed" id="id29">Block, Undistributed</a></li>
<li><a class="reference internal" href="#unstructured" id="id30">Unstructured</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id31">References</a></li>
</ul>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id19">Overview</a></h1>
<p>The Distributed Array Protocol (DAP) is a process-local protocol that allows
two subscribers, called the &quot;producer&quot; and the &quot;consumer&quot; or the &quot;exporter&quot; and
the &quot;importer&quot;, to communicate the essential data and metadata necessary to
share a distributed-memory array between them.  This allows two independently
developed components to access, modify, and update a distributed array without
copying.  The protocol formalizes the metadata and buffers involved in the
transfer, allowing several distributed array projects to collaborate,
facilitating interoperability.  By not copying the underlying array data, the
protocol allows for efficient sharing of array data.</p>
<p>The DAP is intended to build on the concepts and implementation of the existing
PEP-3118 buffer protocol <a class="footnote-reference" href="#bufferprotocol" id="id1">[4]</a>, and uses PEP-3118 buffers (and
subscribing Python objects such as memoryviews and NumPy arrays) as components.</p>
<p>This version of the DAP is defined for the Python language.  Future versions of
this protocol may provide definitions in other languages.</p>
</div>
<div class="section" id="usecases">
<h1><a class="toc-backref" href="#id20">Usecases</a></h1>
<p>Some usecases supported by v1.0 of the protocol include:</p>
<ul class="simple">
<li>Block, cyclic, and block-cyclic distributions for structured decomposition.</li>
<li>Padded block-distributed arrays, including boundary cells for physical
boundary conditions, and communication buffers for storing and updating
values in finite-differencing applications.</li>
<li>Unstructured distributions for arbitrary mappings between global indices and
local data.</li>
<li>Multi-dimensional arrays.</li>
<li>Different distributions for each array dimension.</li>
<li>Dense and sparse (or structured and unstructured) arrays.</li>
<li>Compatibility with array views and slices.</li>
</ul>
</div>
<div class="section" id="sources">
<h1><a class="toc-backref" href="#id21">Sources</a></h1>
<p>The primary sources and inspiration for the DAP are:</p>
<ul class="simple">
<li>Trilinos <a class="footnote-reference" href="#trilinos" id="id2">[7]</a> and PyTrilinos <a class="footnote-reference" href="#pytrilinos" id="id3">[8]</a></li>
<li>Global Arrays <a class="footnote-reference" href="#globalarrays" id="id4">[9]</a> and Global Arrays in NumPy (GAiN) <a class="footnote-reference" href="#gain" id="id5">[10]</a></li>
<li>The Chapel <a class="footnote-reference" href="#chapel" id="id6">[11]</a>, X10 <a class="footnote-reference" href="#x10" id="id7">[12]</a>, and HP-Fortran <a class="footnote-reference" href="#hpfortran" id="id8">[13]</a> languages</li>
<li>Distributed array implementation in the Julia <a class="footnote-reference" href="#julia" id="id9">[14]</a> language</li>
<li>NumPy <a class="footnote-reference" href="#numpy" id="id10">[15]</a> and the Revised Buffer Protocol <a class="footnote-reference" href="#bufferprotocol" id="id11">[4]</a></li>
</ul>
</div>
<div class="section" id="definitions">
<h1><a class="toc-backref" href="#id22">Definitions</a></h1>
<dl class="docutils">
<dt>process</dt>
<dd>A &quot;process&quot; is the basic unit of execution and is as defined in MPI
<a class="footnote-reference" href="#mpi" id="id12">[1]</a>.  It is also analogous to an IPython.parallel <a class="footnote-reference" href="#ipythonparallel" id="id13">[3]</a>
engine.  Each process has an address space, has one or more namespaces that
contain objects, and is able to communicate with other processes to send
and receive data.</dd>
<dt>distributed array</dt>
<dd><p class="first">A single logical array of arbitrary dimensionality that is divided among
multiple processes.</p>
<p class="last">A distributed array has both a global and a local index space for each
dimension, and a mapping between the two index spaces.</p>
</dd>
<dt>local index</dt>
<dd>A local index specifies a location in an array's data at the process level.</dd>
<dt>global index</dt>
<dd>A global index specifies a location in the array's data as if the array
were not distributed.</dd>
<dt>map</dt>
<dd>A map object provides two functionalities: the first is the ability to
translate a global index into a process identifier and a local index on
that process; the second is the ability to provide the global index that
corresponds to a given local index.</dd>
<dt>boundary padding</dt>
<dd>Padding indices in a local array that indicate which indices are part of
the logical <em>boundary</em> of the entire domain.  These are physical or real
boundaries and correspond to the cells or indices that are involved with
the physical system's boundary conditions in a PDE application, for
example.  These boundary padding cells would exist even if the array were
not distributed.</dd>
<dt>communication padding</dt>
<dd>Padding indices that are shared logically with a neighboring local array.
These padding regions are used often in finite differencing applications
and reserve room for communication with neighboring arrays when data
updates are required.</dd>
</dl>
</div>
<div class="section" id="exporting-a-distributed-array">
<h1><a class="toc-backref" href="#id23">Exporting a Distributed Array</a></h1>
<p>A &quot;producer&quot; object that subscribes to the DAP shall provide a method named
<tt class="docutils literal">__distarray__</tt> that, when called by a consumer, returns a dictionary with
three keys: <tt class="docutils literal">'__version__'</tt>, <tt class="docutils literal">'buffer'</tt>, and <tt class="docutils literal">'dim_data'</tt>.</p>
<p>The value associated with the <tt class="docutils literal">'__version__'</tt> key shall be a string of the
form <tt class="docutils literal">'major.minor.patch'</tt>, as described in the Semantic Versioning
specification <a class="footnote-reference" href="#semver" id="id14">[5]</a> and PEP-440 <a class="footnote-reference" href="#pep440" id="id15">[6]</a>.  As specified in Semantic
Versioning, versions of the protocol that differ in the minor version number
shall be backwards compatible; versions that differ in the major version number
may break backwards compatibility.</p>
<p>The value associated with the <tt class="docutils literal">'buffer'</tt> key shall be a Python object that is
compatible with the PEP-3118 buffer protocol and contains the data for a local
section of a distributed array.</p>
<p>The value for the <tt class="docutils literal">'dim_data'</tt> key shall be a tuple of dictionaries, called
&quot;dimension dictionaries&quot;, containing one dictionary for each dimension of the
distributed array, with the zeroth dictionary associated with the zeroth
dimension of the array, and so on for each dimension in succession. There is
one dimension dictionary per dimension, <strong>whether or not that dimension is
distributed</strong>.  These dictionaries are intended to include all metadata
required to fully specify a distributed array's distribution information.</p>
</div>
<div class="section" id="dimension-dictionaries">
<h1><a class="toc-backref" href="#id24">Dimension Dictionaries</a></h1>
<p>All dimension dictionaries shall have a <tt class="docutils literal">'dist_type'</tt> key with a value of
type string.  The <tt class="docutils literal">dist_type</tt> of a dimension specifies the kind of
distribution for that dimension (or no distribution for value <tt class="docutils literal">'n'</tt>).</p>
<p>The following dist_types are currently supported:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="17%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">name</th>
<th class="head">dist_type</th>
<th class="head">required keys</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>undistributed</td>
<td>'n'</td>
<td>'dist_type', 'size'</td>
</tr>
<tr><td>block</td>
<td>'b'</td>
<td>common, 'start', 'stop'</td>
</tr>
<tr><td>cyclic</td>
<td>'c'</td>
<td>common, 'start'</td>
</tr>
<tr><td>block-cyclic</td>
<td>'bc'</td>
<td>common, 'start', 'block_size'</td>
</tr>
<tr><td>block-padded</td>
<td>'bp'</td>
<td>common, 'start', 'stop', 'padding'</td>
</tr>
<tr><td>unstructured</td>
<td>'u'</td>
<td>common, 'indices'</td>
</tr>
</tbody>
</table>
<p>where &quot;common&quot; represents the keys common to all distributed dist_types:
<tt class="docutils literal">'dist_type'</tt>, <tt class="docutils literal">'size'</tt>, <tt class="docutils literal">'proc_grid_size'</tt>, and
<tt class="docutils literal">'proc_grid_rank'</tt>.</p>
<p>Other dist_types may be added in future versions of the protocol.</p>
<div class="section" id="required-key-value-pairs">
<h2><a class="toc-backref" href="#id25">Required key-value pairs</a></h2>
<p>All dimension dictionaries (regardless of distribution type) must define the
following key-value pairs:</p>
<ul>
<li><p class="first"><tt class="docutils literal">'dist_type'</tt> : <tt class="docutils literal">{'n', 'b', 'c', 'bc', 'bp', 'u'}</tt></p>
<p>The distribution type; the primary way to determine the kind of distribution
for this dimension.</p>
</li>
<li><p class="first"><tt class="docutils literal">'size'</tt> : <tt class="docutils literal">int</tt>, &gt;= 0</p>
<p>Total number of global array elements along this dimension.</p>
</li>
</ul>
<p>All <em>distributed</em> dimensions shall have the following keys in their dimension
dictionary, with the associated value:</p>
<ul>
<li><p class="first"><tt class="docutils literal">'proc_grid_size'</tt> : <tt class="docutils literal">int</tt>, &gt;= 1</p>
<p>The total number of processes in the process grid in this dimension.
Necessary for computing the global / local index mapping, etc.</p>
<p>Constraint: the product of all proc_grid_sizes for all distributed dimensions
shall equal the total number of processes in the communicator.</p>
</li>
<li><p class="first"><tt class="docutils literal">proc_grid_rank</tt> : <tt class="docutils literal">int</tt></p>
<p>The rank of the process for this dimension in the process grid.  This
information allows the consumer to determine where the neighbor sections of
an array are located.</p>
<p>The MPI standard guarantees that Cartesian process coordinates are always
assigned to ranks in the same way <a class="footnote-reference" href="#mpivirtualtopologies" id="id16">[2]</a>.</p>
</li>
</ul>
</div>
<div class="section" id="optional-key-value-pairs">
<h2><a class="toc-backref" href="#id26">Optional key-value pairs</a></h2>
<ul>
<li><p class="first"><tt class="docutils literal">'periodic'</tt> : <tt class="docutils literal">bool</tt></p>
<p>Indicates whether this dimension is periodic.  When not present, indicates
this dimension is not periodic, equivalent to a value of <cite>False</cite>.</p>
</li>
</ul>
</div>
<div class="section" id="distribution-type-specific-key-value-pairs">
<h2><a class="toc-backref" href="#id27">Distribution-type specific key-value pairs</a></h2>
<p>The remaining key-value pairs in each dimension dictionary depend on the
<tt class="docutils literal">dist_type</tt> and are described below:</p>
<ul>
<li><p class="first">undistributed (<tt class="docutils literal">dist_type</tt> is <tt class="docutils literal">'n'</tt>):</p>
<p>No additional keys required.</p>
</li>
<li><p class="first">block (<tt class="docutils literal">dist_type</tt> is <tt class="docutils literal">'b'</tt>):</p>
<ul>
<li><p class="first"><tt class="docutils literal">start</tt> : <tt class="docutils literal">int</tt>, &gt;= 0</p>
<p>The start index (inclusive and 0-based) of the global index space available
on this process.</p>
</li>
<li><p class="first"><tt class="docutils literal">stop</tt> : <tt class="docutils literal">int</tt>, &gt; <tt class="docutils literal">start</tt> value</p>
<p>The stop index (exclusive, as in standard Python indexing) of the global
index space available on this process.</p>
</li>
</ul>
<p>For a block-distributed dimension, adjacent processes as determined by the
dimension dictionary's <tt class="docutils literal">proc_grid_rank</tt> field shall have adjacent global
index ranges, i.e., for two processes <tt class="docutils literal">a</tt> and <tt class="docutils literal">b</tt> with grid ranks <tt class="docutils literal">i</tt>
and <tt class="docutils literal">i+1</tt> respectively, the <tt class="docutils literal">stop</tt> of <tt class="docutils literal">a</tt> shall be equal to the
<tt class="docutils literal">start</tt> of <tt class="docutils literal">b</tt>.  Processes may contain differently-sized global index
ranges.</p>
</li>
<li><p class="first">cyclic (<tt class="docutils literal">dist_type</tt> is <tt class="docutils literal">'c'</tt>):</p>
<ul>
<li><p class="first"><tt class="docutils literal">start</tt> : <tt class="docutils literal">int</tt>, &gt;= 0</p>
<p>The start index (inclusive and 0-based) of the global index space available
on this process.</p>
<p>The cyclic distribution is what results from assigning global indices to
the processes in a distributed dimension in round-robin fashion.  A
constraint for cyclic is that the Python slice formed from the <tt class="docutils literal">start</tt>,
<tt class="docutils literal">size</tt>, and <tt class="docutils literal">proc_grid_size</tt> values reproduces the local array's
indices as in standard NumPy slicing.</p>
</li>
</ul>
</li>
<li><p class="first">block-cyclic (<tt class="docutils literal">dist_type</tt> is <tt class="docutils literal">'bc'</tt>):</p>
<ul>
<li><p class="first"><tt class="docutils literal">start</tt> : <tt class="docutils literal">int</tt>, &gt;= 0</p>
<p>The start index (inclusive and 0-based) of the global index space available
on this process.</p>
</li>
<li><p class="first"><tt class="docutils literal">block_size</tt> : <tt class="docutils literal">int</tt>, &gt;= 1</p>
<p>Indicates the size of the contiguous blocks for this dimension.</p>
<p>Block-cyclic can be thought of as analogous to the cyclic distribution, but
it distributes contiguous blocks of global indices in round robin fashion
rather than single indices.  In this way block-cyclic is a generalization
of the block and cyclic distribution types (for an evenly distributed block
distribution).  When block_size == 1, block-cyclic is equivalent to cyclic;
when block_size == ceil(size / proc_grid_size), block cyclic is equivalent
to block.</p>
<p>The block-cyclic distribution is discussed at length elsewhere
(<a class="footnote-reference" href="#bcnetlib" id="id17">[16]</a>, <a class="footnote-reference" href="#bcibm" id="id18">[17]</a>).</p>
</li>
</ul>
</li>
<li><p class="first">block-padded (<tt class="docutils literal">dist_type</tt> is <tt class="docutils literal">'bp'</tt>)</p>
<p>Analogous to the block distribution type but with an extra <tt class="docutils literal">padding</tt> key.
This distribution type allows adjacent local array sections to overlap in
global index space.  Whenever an element of the <tt class="docutils literal">padding</tt> tuple is &gt; 0,
that indicates this array shares indices with its neighbor (as determined by
<tt class="docutils literal">proc_grid_rank</tt>), and further, that this neighboring process owns the
data.</p>
<ul>
<li><p class="first"><tt class="docutils literal">start</tt> and <tt class="docutils literal">stop</tt> as in the block distribution type</p>
</li>
<li><p class="first"><tt class="docutils literal">padding</tt> : 2-tuple of <tt class="docutils literal">int</tt>, each &gt;= 0.</p>
<p>Indicates the number of &quot;padding&quot; values at the lower and upper limits
(respectively) of the indices available on this process.  This padding can
be either &quot;boundary padding&quot; or &quot;communication padding&quot;.</p>
</li>
</ul>
</li>
<li><p class="first">unstructured (<tt class="docutils literal">dist_type</tt> is <tt class="docutils literal">'u'</tt>):</p>
<ul>
<li><p class="first"><tt class="docutils literal">indices</tt>: list of <tt class="docutils literal">int</tt></p>
<p>Global indices available on this process.</p>
</li>
</ul>
<p>[TODO: fill in details, constraints.]</p>
</li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h1><a class="toc-backref" href="#id28">Examples</a></h1>
<div class="section" id="block-undistributed">
<h2><a class="toc-backref" href="#id29">Block, Undistributed</a></h2>
<p>Assume we have a process grid with 2 rows and 1 column, and we have a 2x10
array <tt class="docutils literal">a</tt> distributed over it.  Let <tt class="docutils literal">a</tt> be a two-dimensional array with a
block-distributed 0th dimension and an undistributed 1st dimension.</p>
<p>In process 0:</p>
<pre class="code python literal-block">
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span> <span class="operator">=</span> <span class="name">a0</span><span class="operator">.</span><span class="name">__distarray__</span><span class="punctuation">()</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="operator">.</span><span class="name">keys</span><span class="punctuation">()</span>
<span class="punctuation">[</span><span class="literal string">'__version__'</span><span class="punctuation">,</span> <span class="literal string">'buffer'</span><span class="punctuation">,</span> <span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'__version__'</span><span class="punctuation">]</span>
<span class="literal string">'1.0.0'</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'buffer'</span><span class="punctuation">]</span>
<span class="name">array</span><span class="punctuation">([</span> <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">0.6</span><span class="punctuation">,</span>  <span class="literal number float">0.9</span><span class="punctuation">,</span>  <span class="literal number float">0.6</span><span class="punctuation">,</span>  <span class="literal number float">0.8</span><span class="punctuation">,</span>  <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">0.3</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">])</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="punctuation">({</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">2</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'b'</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_rank'</span><span class="punctuation">:</span> <span class="literal number integer">0</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_size'</span><span class="punctuation">:</span> <span class="literal number integer">2</span><span class="punctuation">,</span>
  <span class="literal string">'start'</span><span class="punctuation">:</span> <span class="literal number integer">0</span><span class="punctuation">,</span>
  <span class="literal string">'stop'</span><span class="punctuation">:</span> <span class="literal number integer">1</span><span class="punctuation">},</span>
 <span class="punctuation">{</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">10</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'n'</span><span class="punctuation">})</span>
</pre>
<p>In process 1:</p>
<pre class="code python literal-block">
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span> <span class="operator">=</span> <span class="name">a1</span><span class="operator">.</span><span class="name">__distarray__</span><span class="punctuation">()</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="operator">.</span><span class="name">keys</span><span class="punctuation">()</span>
<span class="punctuation">[</span><span class="literal string">'__version__'</span><span class="punctuation">,</span> <span class="literal string">'buffer'</span><span class="punctuation">,</span> <span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'__version__'</span><span class="punctuation">]</span>
<span class="literal string">'1.0.0'</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'buffer'</span><span class="punctuation">]</span>
<span class="name">array</span><span class="punctuation">([</span> <span class="literal number float">0.9</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">1.</span> <span class="punctuation">,</span>  <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">,</span>  <span class="literal number float">0.</span> <span class="punctuation">,</span>  <span class="literal number float">0.6</span><span class="punctuation">,</span>  <span class="literal number float">0.8</span><span class="punctuation">,</span>  <span class="literal number float">0.6</span><span class="punctuation">,</span>  <span class="literal number float">1.</span> <span class="punctuation">])</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="punctuation">({</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">2</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'b'</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_rank'</span><span class="punctuation">:</span> <span class="literal number integer">1</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_size'</span><span class="punctuation">:</span> <span class="literal number integer">2</span><span class="punctuation">,</span>
  <span class="literal string">'start'</span><span class="punctuation">:</span> <span class="literal number integer">1</span><span class="punctuation">,</span>
  <span class="literal string">'stop'</span><span class="punctuation">:</span> <span class="literal number integer">2</span><span class="punctuation">},</span>
 <span class="punctuation">{</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">10</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'n'</span><span class="punctuation">})</span>
</pre>
</div>
<div class="section" id="unstructured">
<h2><a class="toc-backref" href="#id30">Unstructured</a></h2>
<p>Assume we have a process grid with 3 rows, and we have a size 30 array <tt class="docutils literal">a</tt>
distributed over it.  Let <tt class="docutils literal">a</tt> be a one-dimensional unstructured array with 7
elements on process 0, 3 elements on process 1, and 20 elements on process 2.</p>
<p>On all processes:</p>
<pre class="code python literal-block">
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span> <span class="operator">=</span> <span class="name">local_array</span><span class="operator">.</span><span class="name">__distarray__</span><span class="punctuation">()</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="operator">.</span><span class="name">keys</span><span class="punctuation">()</span>
<span class="punctuation">[</span><span class="literal string">'__version__'</span><span class="punctuation">,</span> <span class="literal string">'buffer'</span><span class="punctuation">,</span> <span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'__version__'</span><span class="punctuation">]</span>
<span class="literal string">'1.0.0'</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">len</span><span class="punctuation">(</span><span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'dim_data'</span><span class="punctuation">])</span> <span class="operator">==</span> <span class="literal number integer">1</span>  <span class="comment"># one dimension only</span>
<span class="name builtin pseudo">True</span>
</pre>
<p>In process 0:</p>
<pre class="code python literal-block">
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'buffer'</span><span class="punctuation">]</span>
<span class="name">array</span><span class="punctuation">([</span><span class="literal number float">0.7</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">,</span>  <span class="literal number float">0.9</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">0.7</span><span class="punctuation">,</span>  <span class="literal number float">0.0</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">])</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="punctuation">({</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">30</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'u'</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_rank'</span><span class="punctuation">:</span> <span class="literal number integer">0</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_size'</span><span class="punctuation">:</span> <span class="literal number integer">3</span><span class="punctuation">,</span>
  <span class="literal string">'indices'</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="literal number integer">19</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">12</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="punctuation">,</span> <span class="literal number integer">15</span><span class="punctuation">,</span> <span class="literal number integer">4</span><span class="punctuation">]},)</span>
</pre>
<p>In process 1:</p>
<pre class="code python literal-block">
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'buffer'</span><span class="punctuation">]</span>
<span class="name">array</span><span class="punctuation">([</span><span class="literal number float">0.1</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">,</span>  <span class="literal number float">0.9</span><span class="punctuation">])</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="punctuation">({</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">30</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'u'</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_rank'</span><span class="punctuation">:</span> <span class="literal number integer">1</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_size'</span><span class="punctuation">:</span> <span class="literal number integer">3</span><span class="punctuation">,</span>
  <span class="literal string">'indices'</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="literal number integer">6</span><span class="punctuation">,</span> <span class="literal number integer">13</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">]},)</span>
</pre>
<p>In process 2:</p>
<pre class="code python literal-block">
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'buffer'</span><span class="punctuation">]</span>
<span class="name">array</span><span class="punctuation">([</span> <span class="literal number float">0.1</span><span class="punctuation">,</span>  <span class="literal number float">0.8</span><span class="punctuation">,</span>  <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.8</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.3</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">,</span>  <span class="literal number float">0.7</span><span class="punctuation">,</span>
        <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.7</span><span class="punctuation">,</span>  <span class="literal number float">0.6</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">,</span>  <span class="literal number float">0.8</span><span class="punctuation">,</span>  <span class="literal number float">0.5</span><span class="punctuation">,</span>  <span class="literal number float">0.3</span><span class="punctuation">,</span>  <span class="literal number float">0.8</span><span class="punctuation">,</span>  <span class="literal number float">0.4</span><span class="punctuation">,</span>  <span class="literal number float">0.2</span><span class="punctuation">])</span>
<span class="operator">&gt;&gt;&gt;</span> <span class="name">distbuffer</span><span class="punctuation">[</span><span class="literal string">'dim_data'</span><span class="punctuation">]</span>
<span class="punctuation">({</span><span class="literal string">'size'</span><span class="punctuation">:</span> <span class="literal number integer">30</span><span class="punctuation">,</span>
  <span class="literal string">'dist_type'</span><span class="punctuation">:</span> <span class="literal string">'u'</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_rank'</span><span class="punctuation">:</span> <span class="literal number integer">2</span><span class="punctuation">,</span>
  <span class="literal string">'proc_grid_size'</span><span class="punctuation">:</span> <span class="literal number integer">3</span><span class="punctuation">,</span>
  <span class="literal string">'indices'</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">25</span><span class="punctuation">,</span>  <span class="literal number integer">5</span><span class="punctuation">,</span> <span class="literal number integer">21</span><span class="punctuation">,</span>  <span class="literal number integer">7</span><span class="punctuation">,</span> <span class="literal number integer">18</span><span class="punctuation">,</span> <span class="literal number integer">11</span><span class="punctuation">,</span> <span class="literal number integer">26</span><span class="punctuation">,</span> <span class="literal number integer">29</span><span class="punctuation">,</span> <span class="literal number integer">24</span><span class="punctuation">,</span> <span class="literal number integer">23</span><span class="punctuation">,</span> <span class="literal number integer">28</span><span class="punctuation">,</span> <span class="literal number integer">14</span><span class="punctuation">,</span>
              <span class="literal number integer">20</span><span class="punctuation">,</span>  <span class="literal number integer">9</span><span class="punctuation">,</span> <span class="literal number integer">16</span><span class="punctuation">,</span> <span class="literal number integer">27</span><span class="punctuation">,</span>  <span class="literal number integer">8</span><span class="punctuation">,</span> <span class="literal number integer">17</span><span class="punctuation">,</span> <span class="literal number integer">22</span><span class="punctuation">]},)</span>
</pre>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id31">References</a></h1>
<table class="docutils footnote" frame="void" id="mpi" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[1]</a></td><td>Message Passing Interface.  <a class="reference external" href="http://www.open-mpi.org/">http://www.open-mpi.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="mpivirtualtopologies" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[2]</a></td><td>MPI-2.2 Standard: Virtual Topologies.
<a class="reference external" href="http://www.mpi-forum.org/docs/mpi-2.2/mpi22-report/node165.htm#Node165">http://www.mpi-forum.org/docs/mpi-2.2/mpi22-report/node165.htm#Node165</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ipythonparallel" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[3]</a></td><td>IPython Parallel.
<a class="reference external" href="http://ipython.org/ipython-doc/dev/parallel/">http://ipython.org/ipython-doc/dev/parallel/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="bufferprotocol" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id11">2</a>)</em> Revising the Buffer Protocol.
<a class="reference external" href="http://www.python.org/dev/peps/pep-3118/">http://www.python.org/dev/peps/pep-3118/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="semver" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[5]</a></td><td>Semantic Versioning 2.0.0.  <a class="reference external" href="http://semver.org/">http://semver.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="pep440" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15">[6]</a></td><td>PEP 440: Version Identification and Dependency
Specification.  <a class="reference external" href="http://www.python.org/dev/peps/pep-0440/">http://www.python.org/dev/peps/pep-0440/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="trilinos" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[7]</a></td><td>Trilinos. <a class="reference external" href="http://trilinos.sandia.gov/">http://trilinos.sandia.gov/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="pytrilinos" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[8]</a></td><td>PyTrilinos.
<a class="reference external" href="http://trilinos.sandia.gov/packages/pytrilinos/">http://trilinos.sandia.gov/packages/pytrilinos/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="globalarrays" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[9]</a></td><td>Global Arrays. <a class="reference external" href="http://hpc.pnl.gov/globalarrays/">http://hpc.pnl.gov/globalarrays/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="gain" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[10]</a></td><td>Global Arrays in NumPy.
<a class="reference external" href="http://www.pnnl.gov/science/highlights/highlight.asp?id=1043">http://www.pnnl.gov/science/highlights/highlight.asp?id=1043</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="chapel" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[11]</a></td><td>Chapel. <a class="reference external" href="http://chapel.cray.com/">http://chapel.cray.com/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="x10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[12]</a></td><td>X10. <a class="reference external" href="http://x10-lang.org/">http://x10-lang.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="hpfortran" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[13]</a></td><td>High Perfomance Fortran. <a class="reference external" href="http://dacnet.rice.edu/">http://dacnet.rice.edu/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="julia" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[14]</a></td><td>Julia. <a class="reference external" href="http://docs.julialang.org">http://docs.julialang.org</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="numpy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[15]</a></td><td>NumPy. <a class="reference external" href="http://www.numpy.org/">http://www.numpy.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="bcnetlib" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[16]</a></td><td>ScaLAPACK Users' Guide: The Two-dimensional Block-Cyclic Distribution.
<a class="reference external" href="http://netlib.org/scalapack/slug/node75.html">http://netlib.org/scalapack/slug/node75.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="bcibm" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[17]</a></td><td>Parallel ESSL Guide and Reference: Block-Cyclic Distribution over Two-Dimensional Process Grids.
<a class="reference external" href="http://publib.boulder.ibm.com/infocenter/clresctr/vxrx/index.jsp?topic=%2Fcom.ibm.cluster.pessl.v4r2.pssl100.doc%2Fam6gr_dvtdpg.htm">http://publib.boulder.ibm.com/infocenter/clresctr/vxrx/index.jsp?topic=%2Fcom.ibm.cluster.pessl.v4r2.pssl100.doc%2Fam6gr_dvtdpg.htm</a></td></tr>
</tbody>
</table>
<!-- vim:spell:ft=rst:tw=79 -->
</div>
</div>
</body>
</html>
